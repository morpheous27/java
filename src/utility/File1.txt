<?xml version="1.0"?>
<!--***************************************************************************
This source is part of the Oracle FLEXCUBE Direct Banking Software Product. 
Copyright  2008,2014, Oracle and/or its affiliates.  All rights reserved. 

No part of this work may be reproduced, stored in a retrieval system, 
adopted or transmitted in any form or by any means, electronic, mechanical, 
photographic, graphic, optic recording or otherwise, translated in any language 
or computer language, without the prior written permission of Oracle and/or 
its affiliates. 

Oracle Financial Services Software Limited.
Oracle Park, Off Western Express Highway,
Goregaon (East), 
Mumbai - 400 063, India.


Modification History


Date		Version		Author				Description
__________	___________	_______________		__________________________
15 02 2014	1.0			Sagar P				Deleted earlier history. 
											Since it was not applicable post 12.0.3 changes.
											Done 1203 revamp changes.
26 02 2014	2.0			Sagar P				Added support for Goals. 
04 03 2014	3.0			Sagar P				Added support for Credit cards. 
12 03 2014	4.0			Sagar P				Added support for Credit cards 
											equivalent currency. 
12 03 2014	5.0			Sunil T				Added support for Mutual Funds.
10 04 2014	6.0			Sagar P				Added support for financial 
											instrument.
17 04 2014	7.0			Sagar P				Added class 'acct_summary'.
13 05 2014	8.0			Craig F				Added Private Banking details to financial instrument
14 05 2014	8.1			Craig F				Redirect to Account Summary Page 2 if coming from financial summary widget
28 05 2014	8.2			Sameer Karve		Added wrapper div to fix layout issue in Firefox
26 06 2014  8.3			Craig F				Removed redirection as page goes directly to RRASM14
18 07 2014	8.4			Sagar P				Added hyperlink on bullet image.
24 07 2014	8.5			Mona P				change img tag to span for bullet image.
29 09 2014	8.6			Mona P				Removed styles and added class/id
16 01 2015	8.7			Mayur Kalebere		Modified fnGetAccntSumDetails() to resolve Bug No.20356591
*****************************************************************************-->
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xml:space="default" version="1.0" xmlns:java="http://xml.apache.org/xslt/java" xmlns:str="http://exslt.org/strings" exclude-result-prefixes="str java" > 
<xsl:import href="common.xsl" />
<xsl:include href="graph.xsl" />
<xsl:include href="dateformatter.xsl"/>
<xsl:output doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN" method="html" indent="yes" />
<xsl:key name="debitidcust" match="//faml/response/totalpositionresponsedto/carddetails/carddetailsdto/account/accountnodto" use="idcustomer"/>
<xsl:template match="/">

<xsl:variable name="idlang"><xsl:value-of select="//faml/response/sessioninfo/@idlang"/></xsl:variable>
<xsl:variable name = "localcurr"><xsl:value-of select="//faml/response/totalpositionresponsedto/extendedresponse/extendedresponsedto/localcurrency"/></xsl:variable>
<xsl:variable name = "currency">
<xsl:choose>
<xsl:when test= "count(//faml/request/cmbcurrency) = 0"><xsl:value-of select ="$localcurr" /></xsl:when>
<xsl:otherwise><xsl:value-of select ="//faml/request/cmbcurrency"/></xsl:otherwise>
</xsl:choose>
</xsl:variable>
<xsl:variable name="nameCASA">Current Account &amp; Savings Account (Conventional)</xsl:variable>
<xsl:variable name="nameiCASA">Islamic Current Account &amp; Savings Account</xsl:variable>
<xsl:variable name="nameTD">Term Deposits</xsl:variable>
<xsl:variable name="nameiTD">Islamic Deposits</xsl:variable>
<xsl:variable name="namecTD">Contract Term Deposits</xsl:variable>
<xsl:variable name="nameLOAN">Loans</xsl:variable>
<xsl:variable name="nameiLOAN">Islamic Financing</xsl:variable>
<xsl:variable name="nameCards">Credit Cards</xsl:variable>
<xsl:variable name="nameGoals">Goals</xsl:variable>
<xsl:variable name="nameMFs">Mutual Funds</xsl:variable>
<xsl:variable name="nameFI">Financial Instruments</xsl:variable>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title> Account Summary </title>
<link href="css/default.css" type="text/css" rel="STYLESHEET"/>
<xsl:apply-imports />
<script language="javascript" type="text/JavaScript" src='jsdir/common.js'></script>
<script language="JavaScript" type="text/JavaScript" src='jsdir/Ajax.js'></script>
<script language="javascript" type="text/JavaScript">
var l_custsArr = new Array ();
var l_arrSprtType = new Array ('C','S','T','M','Z','L','F','CC','O','U','FI');
var l_flagClickedType = '';
//-----------------------------------------------------------------------------
function fnGetCurSpecDet () {
	SendTxnRequest ('01','ASM');
}
//-----------------------------------------------------------------------------
function fnGetCustView () {
	var l_custId = document.frmmain.fldcustomers.value;
	if (l_custId == "") {
		document.getElementById ("allcustacttypdiv").style.display = "";
		for (var l_i=1; l_i &lt; document.frmmain.fldcustomers.length ; l_i++) {
			document.getElementById (document.frmmain.fldcustomers [l_i].value+"acttypdiv").style.display = "none";
		}
	} else {
		document.getElementById ("allcustacttypdiv").style.display = "none";
		for (var l_i=1; l_i &lt; document.frmmain.fldcustomers.length ; l_i++) {
			if (document.frmmain.fldcustomers [l_i].value == l_custId) {
				document.getElementById (document.frmmain.fldcustomers [l_i].value+"acttypdiv").style.display = "";
			} else {
				document.getElementById (document.frmmain.fldcustomers [l_i].value+"acttypdiv").style.display = "none";
			}
		}
	}
}
//-----------------------------------------------------------------------------
function fnGetAcntTypeName (p_acntType) {
	var l_str;
	switch (p_acntType) {
		case 'C':
			l_str = '<xsl:value-of select="$nameCASA"/>';
			break;
		case 'S':
			l_str = '<xsl:value-of select="$nameiCASA"/>';
			break;
		case 'T':
			l_str = '<xsl:value-of select="$nameTD"/>';
			break;
		case 'M':
			l_str = '<xsl:value-of select="$nameiTD"/>';
			break;
		case 'Z':
			l_str = '<xsl:value-of select="$namecTD"/>';
			break;
		case 'L':
			l_str = '<xsl:value-of select="$nameLOAN"/>';
			break;
		case 'F':
			l_str = '<xsl:value-of select="$nameiLOAN"/>';
			break;
		case 'CC':
			l_str = '<xsl:value-of select="$nameCards"/>';
			break;
		case 'O':
			l_str = '<xsl:value-of select="$nameGoals"/>';
			break;
		case 'U':
			l_str = '<xsl:value-of select="$nameMFs"/>';
			break;
		default:
			l_str = p_acntType;
	}
	return l_str;
}

//-----------------------------------------------------------------------------
function fnResetRequestValues () {
	var l_cust = '<xsl:value-of select="/faml/request/fldcustomers"/>';
	if (l_cust != '') {
		for (var l_i= 0 ; l_i &lt; document.frmmain.fldcustomers.length; l_i++) {
			if (l_cust == document.frmmain.fldcustomers [l_i].value) {
				document.frmmain.fldcustomers [l_i].selected = true;
				fnGetCustView ();
				break;
			}
		}
	}
}
//-----------------------------------------------------------------------------
function fnOnLoad () {	
	var l_str = '';
	for (var l_i=0 ; l_i &lt; l_arrSprtType.length ; l_i++) {
		l_str += l_arrSprtType [l_i];
		if (l_i &lt; (l_arrSprtType.length-1)) {
			l_str += '~';
		}
	}
	document.frmmain.fldsuptypeslist.value = l_str;
	fnMapCustActType ();
	fnResetRequestValues ();
	if ('<xsl:value-of select="/faml/request/fldfrompage"/>' == 'sumdet' 
		&amp;&amp; '<xsl:value-of select="/faml/request/fldaccounttypes"/>' != '') {
		fnGetAccntSumDetails ('<xsl:value-of select="/faml/request/fldaccounttypes"/>');
	}
	displayStatusMessage ();
}
//-----------------------------------------------------------------------------
function fnMapCustActType () {
	var l_i = 0;
	var l_k = 0;
	var l_str = '';
	<xsl:for-each select="//faml/response/totalpositionresponsedto/custaccounts/customeraccountdto">
	l_str = '<xsl:value-of select="idcustomer"/>~';
	
	var l_arr = new Array ();
	var l_j = 0;
	<xsl:for-each select="accounts/accountnodto">
	var l_acntType = '<xsl:value-of select="accttype"/>';
	var l_flagAdd = 'Y';
	for (l_k=0; l_k &lt; l_arr.length; l_k++) {
		if (l_acntType == l_arr [l_k]) {
			l_flagAdd = 'N';
			break;
		}
	}
	if (l_flagAdd == 'Y') {
		l_arr [l_j++] = l_acntType;
	}
	</xsl:for-each>
	for (l_k=0 ; l_k &lt; l_arr.length ; l_k++) {
		l_str += l_arr [l_k];
		if (l_k &lt; l_arr.length-1) {
			l_str += ',';
		}
	}
	l_custsArr [l_i++] = l_str;
	</xsl:for-each>
}
//-----------------------------------------------------------------------------
function fnHideAccTypesDivs () {
	var l_val = 'none';
	var l_custId = '';
	document.getElementById ('allcustacttypdiv').style.display = l_val;
	<xsl:for-each select="//faml/response/totalpositionresponsedto/custaccounts/customeraccountdto">
	l_custId = '<xsl:value-of select="idcustomer"/>';
	document.getElementById (l_custId+'acttypdiv').style.display = l_val;
	</xsl:for-each>
}
//-----------------------------------------------------------------------------
function fnGetAccntSumDetails (p_acntType) {
	document.frmmain.fldaccounttypes.value = p_acntType;
	document.frmmain.fldDataId.value = '<xsl:value-of select="/faml/request/fldDataId"/>';
	document.frmmain.fldSectionId.value = '<xsl:value-of select="/faml/request/fldRequestId"/>';
	SendTxnRequest ('14','ASM');
}
//-----------------------------------------------------------------------------
</script>
</head>
<body class="workarea" onLoad="fnOnLoad();">
	<xsl:variable name="header"> </xsl:variable>
	<xsl:variable name="footer"></xsl:variable>
	<form action="internet" method="post" name="frmmain">
		<table cellpadding="0" cellspacing="0" border="0" id="mainbox" class="mainbox">
			<tr>
				<td>
				<div>
					<div class="toppanel"><ul><li></li></ul></div>
					
					<div class="dummy" id="dummyId">
					dsgsg
					</div>
					<div class="dummy">
					dsgsg
					</div>
					<div class="dummy">
					dsgsg
					</div>
					<div class="middlepanel">
						<table cellspacing="0" cellpadding="0" border="0" id="maintable" class="maintable">
						<tr id="mainboxrow1">
							<td valign="top">
								<div id="pageheadingpanel">
									<div id="pageheading">Account Summary</div>
									<div id="pageheadingdate"><xsl:call-template name="formatted_date"/></div>
								</div>
							</td>		
						</tr>
						<tr>
							<td height="100%" valign="top">
								<div class="y_scroll" id="contentarea">
									<div class="contentarea">
										
										<span id="box" class="box">
											<div class="topPanel"><ul><li/></ul></div>
											<div class="middlePanel">
												<table border="0" cellspacing="1" cellpadding="1" class="standardtable allcustacttypdiv">
												<tr id="maintablerow2">
												   heh ehe he hehe h change kar k dikhaao
												</tr>
													<tr>
														<td class="headingalign">
															<div id="spanoverview">Overview</div>
															<div id="spanoverview_sel">
																<select name="fldcustomers" type="select-one" class="objselect" style="width:auto; margin:0 0 0 3px;" onchange="fnGetCustView();">
																	<option value="">All Customers</option>
																	<xsl:for-each select="//faml/response/totalpositionresponsedto/custaccounts/customeraccountdto">
																	<option value="{idcustomer}"><xsl:value-of select="idcustomer"/></option>
																	</xsl:for-each>
																	<xsl:for-each select="//faml/response/totalpositionresponsedto/creditcarddetails/creditcarddetailsdto">
																	<option value="{cardno}"><xsl:value-of select="cardno"/></option>
																	</xsl:for-each>
																</select>
																<select name="cmbcurrency" type="select-one" class="objselect" style="width:auto; margin:0 0 0 3px;" onchange="fnGetCurSpecDet();">
																	<xsl:for-each select="//faml/response/totalpositionresponsedto/currencies/currencydto">
																	<xsl:choose>
																	<xsl:when test="codcurrency=$currency">
																	<option value="{codcurrency}" selected="selected"><xsl:value-of select="codcurrency"/></option>
																	</xsl:when>
																	<xsl:otherwise>
																	<option value="{codcurrency}"><xsl:value-of select="codcurrency"/></option>
																	</xsl:otherwise>
																	</xsl:choose>
																	</xsl:for-each>
																</select>
															</div>
														</td>
													</tr>
													
													 
													</tr>
												</table>
												<div class="infotable">
												sdgvs
												
												
												</div>
												<div class="errortable">
												sdgvs
												
												
												</div>
												
												<div id="maintablecontentarea" class="contentarea">
												
												sgfsjkf  he hehe hh
													
												</div>
												<table id="disclaimerheader" class="infotable" border="0" cellpadding="1" cellspacing="1" >
												
												<tr><td> </td> </tr>
												 <tr id="disclaimerheaderrow1">
													<td id="disclaimerheaderrow1col1">
													
													sdfs haiii again
													</td>
												 
												 </tr>
												  
												</table>
												<table id="disclaimerfooter" class="infotable" border="0" cellpadding="1" cellspacing="1" >
													<tr id="disclaimerfooterrow1">
													 <td id="disclaimerfooterrow1col1">
													    RockStar........... 
													 </td>
													</tr>
												</table>
												
												
												
												<div class="divider"></div>
												<div id="allcustacttypdiv" style="display:block" class="acct_summary">
												<xsl:variable name="totFIlong"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto/longposition/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="totFIshort"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto/shortposition/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="totFIsec"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto/securites/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="totFIshare"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto/shares/financialinstrumentdto/equivalentamount)"/></xsl:variable>												
												<xsl:variable name="totWealth"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto/folios/customerfolio/investmentvalue)"/></xsl:variable>
												
												<xsl:call-template name="accountTypeWiseDet">
												<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
												<xsl:with-param name="nameCASA"><xsl:value-of select="$nameCASA"/></xsl:with-param>
												<xsl:with-param name="nameiCASA"><xsl:value-of select="$nameiCASA"/></xsl:with-param>
												<xsl:with-param name="nameTD"><xsl:value-of select="$nameTD"/></xsl:with-param>
												<xsl:with-param name="nameiTD"><xsl:value-of select="$nameiTD"/></xsl:with-param>
												<xsl:with-param name="namecTD"><xsl:value-of select="$namecTD"/></xsl:with-param>
												<xsl:with-param name="nameLOAN"><xsl:value-of select="$nameLOAN"/></xsl:with-param>
												<xsl:with-param name="nameiLOAN"><xsl:value-of select="$nameiLOAN"/></xsl:with-param>
												<xsl:with-param name="nameCards"><xsl:value-of select="$nameCards"/></xsl:with-param>
												<xsl:with-param name="nameGoals"><xsl:value-of select="$nameGoals"/></xsl:with-param>
												<xsl:with-param name="nameMFs"><xsl:value-of select="$nameMFs"/></xsl:with-param>
												<xsl:with-param name="nameFI"><xsl:value-of select="$nameFI"/></xsl:with-param>
												<xsl:with-param name="customerid">ALL</xsl:with-param>
												<xsl:with-param name="currency"><xsl:value-of select="$currency"/></xsl:with-param>
												<xsl:with-param name="casaAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalcasaamount"/></xsl:with-param>
												<xsl:with-param name="icasaAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalislamiccasaamt"/></xsl:with-param>
												<xsl:with-param name="tdAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totaltdamount"/></xsl:with-param>
												<xsl:with-param name="itdAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalislamictdamt"/></xsl:with-param>
												<xsl:with-param name="cTdAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalconttdamount"/></xsl:with-param>
												<xsl:with-param name="loanAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totallnamount"/></xsl:with-param>
												<xsl:with-param name="iloanAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalislamiclnamt"/></xsl:with-param>
												<xsl:with-param name="mfAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalmfamount"/></xsl:with-param>
												<xsl:with-param name="goalsAmt"><xsl:value-of select="//faml/response/totalpositionresponsedto/totalgoalsamt"/></xsl:with-param>
												<xsl:with-param name="ccBillAmt"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/creditcarddetails/creditcarddetailsdto/equitotalbilledamount)"/></xsl:with-param>
												<xsl:with-param name="fiAmt"><xsl:value-of select="$totFIlong - $totFIshort + $totFIsec + $totFIshare + $totWealth"/></xsl:with-param>
												<xsl:with-param name="casaCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='C'])"/></xsl:with-param>
												<xsl:with-param name="icasaCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='S'])"/></xsl:with-param>
												<xsl:with-param name="tdCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='T'])"/></xsl:with-param>
												<xsl:with-param name="itdCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='M'])"/></xsl:with-param>
												<xsl:with-param name="contracttdCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='Z'])"/></xsl:with-param>
												<xsl:with-param name="loanCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='L'])"/></xsl:with-param>
												<xsl:with-param name="iloanCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='F'])"/></xsl:with-param>
												<xsl:with-param name="ccCardsCnt"><xsl:value-of select="count(//faml/response/totalpositionresponsedto/creditcarddetails/creditcarddetailsdto)"/></xsl:with-param>
												<xsl:with-param name="goalsCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='O'])"/></xsl:with-param>
												<xsl:with-param name="mfCnt"><xsl:value-of select="count(//customeraccountdto/accounts/accountnodto[accttype='U'])"/></xsl:with-param>
												<xsl:with-param name="fiCnt"><xsl:value-of select="count(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto)"/></xsl:with-param>
												</xsl:call-template>													
												</div>
												
												<xsl:for-each select="//faml/response/totalpositionresponsedto/custaccounts/customeraccountdto">
												<xsl:variable name="id_cust"><xsl:value-of select="idcustomer"/></xsl:variable>
												<xsl:variable name="custFIlong"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust]/longposition/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="custFIshort"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust]/shortposition/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="custFIsec"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust]/securites/financialinstrumentdto/equivalentamoun)"/></xsl:variable>
												<xsl:variable name="custFIshare"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust]/shares/financialinstrumentdto/equivalentamount)"/></xsl:variable>
												<xsl:variable name="custWealth"><xsl:value-of select="sum(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust]/folios/customerfolio/investmentvalue)"/></xsl:variable>												

												<div id="{idcustomer}acttypdiv" style="display:none" class="acct_summary">
													<xsl:call-template name="accountTypeWiseDet">
													<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
													<xsl:with-param name="customerid"><xsl:value-of select="$id_cust"/></xsl:with-param>
													<xsl:with-param name="nameCASA"><xsl:value-of select="$nameCASA"/></xsl:with-param>
													<xsl:with-param name="nameiCASA"><xsl:value-of select="$nameiCASA"/></xsl:with-param>
													<xsl:with-param name="nameTD"><xsl:value-of select="$nameTD"/></xsl:with-param>
													<xsl:with-param name="nameiTD"><xsl:value-of select="$nameiTD"/></xsl:with-param>
													<xsl:with-param name="namecTD"><xsl:value-of select="$namecTD"/></xsl:with-param>
													<xsl:with-param name="nameLOAN"><xsl:value-of select="$nameLOAN"/></xsl:with-param>
													<xsl:with-param name="nameiLOAN"><xsl:value-of select="$nameiLOAN"/></xsl:with-param>
													<xsl:with-param name="nameCards"><xsl:value-of select="$nameCards"/></xsl:with-param>
													<xsl:with-param name="nameGoals"><xsl:value-of select="$nameGoals"/></xsl:with-param>
													<xsl:with-param name="nameMFs"><xsl:value-of select="$nameMFs"/></xsl:with-param>
													<xsl:with-param name="currency"><xsl:value-of select="$currency"/></xsl:with-param>
													<xsl:with-param name="nameFI"><xsl:value-of select="$nameFI"/></xsl:with-param>
													<xsl:with-param name="casaAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='C']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="icasaAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='S']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="tdAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='T']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="itdAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='M']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="cTdAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='Z']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="loanAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='L']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="iloanAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='F']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="goalsAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='O']/equivalentbalance)"/></xsl:with-param>
													<xsl:with-param name="ccBillAmt">0</xsl:with-param>
													<xsl:with-param name="mfAmt"><xsl:value-of select="sum(accounts/accountnodto[accttype='U']/balance)"/></xsl:with-param>
													<xsl:with-param name="fiAmt"><xsl:value-of select="$custFIlong - $custFIshort + $custFIsec + $custFIshare + $custWealth"/></xsl:with-param>
													<xsl:with-param name="casaCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='C'])"/></xsl:with-param>
													<xsl:with-param name="icasaCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='S'])"/></xsl:with-param>
													<xsl:with-param name="tdCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='T'])"/></xsl:with-param>
													<xsl:with-param name="itdCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='M'])"/></xsl:with-param>
													<xsl:with-param name="contracttdCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='Z'])"/></xsl:with-param>
													<xsl:with-param name="loanCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='L'])"/></xsl:with-param>
													<xsl:with-param name="iloanCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='F'])"/></xsl:with-param>
													<xsl:with-param name="goalsCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='O'])"/></xsl:with-param>
													<xsl:with-param name="mfCnt"><xsl:value-of select="count(accounts/accountnodto[accttype='U'])"/></xsl:with-param>
													<xsl:with-param name="fiCnt"><xsl:value-of select="count(//faml/response/totalpositionresponsedto/financialinstrument/customerinstrumentdetaildto[custid=$id_cust])"/></xsl:with-param>
													</xsl:call-template>
												</div>
												</xsl:for-each>

												<xsl:for-each select="//faml/response/totalpositionresponsedto/creditcarddetails/creditcarddetailsdto">
												<div id="{cardno}acttypdiv" style="display:none">
												<xsl:call-template name="accountTypeWiseDet">
												<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
												<xsl:with-param name="nameCards"><xsl:value-of select="$nameCards"/></xsl:with-param>
												<xsl:with-param name="ccCardsCnt">1</xsl:with-param>
												<xsl:with-param name="currency"><xsl:value-of select="$currency"/></xsl:with-param>
												<xsl:with-param name="ccBillAmt"><xsl:value-of select="equitotalbilledamount"/></xsl:with-param>
												<xsl:with-param name="needTotalBal">N</xsl:with-param>
												</xsl:call-template>
												</div>
												</xsl:for-each>

											</div>
											<div class="bottompanel"><ul><li/></ul></div>
										</span>

									</div>
								</div>
							</td>
						</tr>
						</table>
					</div>
					<div class="bottompanel"><ul><li></li></ul></div>
				</div>
				</td>
			</tr>
		</table>
		<input type="hidden" name="cmbcurrency"/>
		<input type="hidden" name="fldRequestId" value=""/>	  
		<input type="hidden" name="fldSessionId" value="{//faml/request/fldSessionId}"/>
		<input type="hidden" name="fldServiceType" value="{//faml/request/fldServiceType}"/>
		<input type="hidden" name="fldSectionId" value="{//faml/request/fldSectionId}"/>
		<input type="hidden" name="fldDataId" value="{//faml/request/fldDataId}"/>
		<input type="hidden" name="fldaccounttypes" value=""/>
		<input type="hidden" name="fldsuptypeslist" value=""/>
	</form>
</body>
</html>
</xsl:template>


<!--============= template 2 starts here =============-->
<xsl:template name="accountTypeWiseDet">
<xsl:param name="idlang"/>
<xsl:param name="nameCASA"/>
<xsl:param name="nameiCASA"/>
<xsl:param name="nameTD"/>
<xsl:param name="nameiTD"/>
<xsl:param name="namecTD"/>
<xsl:param name="nameLOAN"/>
<xsl:param name="nameiLOAN"/>
<xsl:param name="nameCards"/>
<xsl:param name="nameGoals"/>
<xsl:param name="nameMFs"/>
<xsl:param name="nameFI"/>
<!-- ======= -->
<xsl:param name="customerid"/>
<xsl:param name="currency"/>
<xsl:param name="idlang"/>
<xsl:param name="casaAmt"/>
<xsl:param name="icasaAmt"/>
<xsl:param name="tdAmt"/>
<xsl:param name="itdAmt"/>
<xsl:param name="cTdAmt"/>
<xsl:param name="loanAmt"/>
<xsl:param name="iloanAmt"/>
<xsl:param name="ccBillAmt"/>
<xsl:param name="goalsAmt"/>
<xsl:param name="mfAmt"/>
<xsl:param name="casaCnt"/>
<xsl:param name="icasaCnt"/>
<xsl:param name="tdCnt"/>
<xsl:param name="itdCnt"/>
<xsl:param name="contracttdCnt"/>
<xsl:param name="loanCnt"/>
<xsl:param name="iloanCnt"/>
<xsl:param name="ccCardsCnt"/>
<xsl:param name="goalsCnt"/>
<xsl:param name="mfCnt"/>
<xsl:param name="needTotalBal"/>
<xsl:param name="fiCnt"/>
<xsl:param name="fiAmt"/>

<xsl:if test="$casaCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameCASA"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$casaAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">C</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$icasaCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameiCASA"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$icasaAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">S</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$tdCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameTD"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$tdAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">T</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$itdCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameiTD"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$itdAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">M</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$contracttdCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$namecTD"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$cTdAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">Z</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$loanCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameLOAN"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$loanAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">L</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$iloanCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameiLOAN"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$iloanAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">F</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$ccCardsCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameCards"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$ccBillAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">CC</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$goalsCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameGoals"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$goalsAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">O</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$mfCnt &gt; 0">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameMFs"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$mfAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">U</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="($fiCnt &gt; 0) and ($fiAmt &gt; 0)">
<xsl:call-template name="accountTypeWiseDet2">
<xsl:with-param name="accountTypeName"><xsl:value-of select="$nameFI"/></xsl:with-param>
<xsl:with-param name="totalAmt"><xsl:value-of select="$fiAmt"/></xsl:with-param>
<xsl:with-param name="eqvlcurrency"><xsl:value-of select="$currency"/></xsl:with-param>
<xsl:with-param name="idlang"><xsl:value-of select="$idlang"/></xsl:with-param>
<xsl:with-param name="acctType">FI</xsl:with-param>
</xsl:call-template>
</xsl:if>

<xsl:if test="$needTotalBal!='N'">
<table border="0" cellspacing="1" cellpadding="1" class="summarytable">
<caption class="" id="caption1">
	<xsl:variable name="tempAmt"><xsl:value-of select="($casaAmt+$icasaAmt+$tdAmt+$goalsAmt+$mfAmt+$fiAmt+(-1*$ccBillAmt))-($loanAmt+$iloanAmt)"/></xsl:variable>
	<span>Total Balance:<xsl:value-of select="concat('&#160;',$currency,'&#160;',java:com.ofss.obcp.framework.utils.JFFormatter.formatCurrency($currency,$tempAmt,$idlang))"/></span>
</caption>
</table>
</xsl:if>

</xsl:template>
<!-- ============ template 2 ends here ============== -->

<!-- template 3 starts -->
<xsl:template name="accountTypeWiseDet2">
<xsl:param name="accountTypeName"/>
<xsl:param name="totalAmt"/>
<xsl:param name="eqvlcurrency"/>
<xsl:param name="idlang"/>
<xsl:param name="acctType"/>
<table border="0" cellspacing="1" cellpadding="1" class="summarytable">
	<caption class="" id="caption1">
		<span>
			<span class="bullet" id="img_div1" border="0" onclick="javascript:fnGetAccntSumDetails ('{$acctType}');" ></span>
			<a href="javascript:fnGetAccntSumDetails ('{$acctType}');"><xsl:value-of select="$accountTypeName"/></a>
		</span>
		<xsl:variable name="tempAmt"><xsl:value-of select="$totalAmt"/></xsl:variable>
		<span class="ccyalign"><xsl:value-of select="concat($eqvlcurrency,'&#160;',java:com.ofss.obcp.framework.utils.JFFormatter.formatCurrency($eqvlcurrency,$tempAmt,$idlang))"/></span>
	</caption>
</table>
</xsl:template>
<!--***************************************************************************
**
**	End of file
**
****************************************************************************-->
</xsl:stylesheet>
